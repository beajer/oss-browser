language: "node_js"

node_js: '12'

branches:
  only:
  - test/ci

env:
  global:
    - GH: github.com/beajer/oss-browser.git
    - secure: a4yFoHZTt6R4Eh244xuC4bLFKwH7I7um8IRizxX4AxsvpoVtw5Yea9Wg2UBu/SnF8IWAF9TKPLmzJ1uY3mhguzLtU8m2NSEZHyC7SzGAoRHXFzi+SxoHufEDAzaSQVos90y/sSuJbcCVKRnb1ReT7amb5FPPied2BObu1Gxp+IrxsCdu0crxnBn+CBW2880sPw19FBWyJ1i5PbSSLKapuvfwV7XR5+a9bYWs+r5WYuEcgNl+yEDFOiZqKeDOa62fxw+nzSCYB7C7/OIW1kVavnvFAJRsMW8UyqGkQVwejdBxeRdM0CUPe0/LxxkuJFxGnGyX0wWEsyZXEVqxj1spmfEIhHygz/5gmzFguK+P0MM25rzbgsvDy2bYE/FxqWcjJ0lJJ9FIfC4afSHh863LiC+ylz3/IVaEb5odFd+R0NpZ1Ig8ffQ2/fLYx8Vpc+QbTgLs06hv59FgTlbEZ6U5RHjG2pYr3RBoccTCAqa90tF7/3260KQbTtm+mHNkDY6r3qEsKMgqDspyhpdTm03LajFN0zcV1szNTdE5+s4gssjg8WvgaTg6Sz4GfGfdGJnDzKqV/6lFFNDo5LZBWDdaU9PG2vAUkOwomBdDxEzY4+AlzuRYr87D6RONH+T+88swK7fh/ezKAEEs4IqY4vibpN7ZCO0doVz58O5HmdPkaR0=

os:
  - linux
  - osx
  - windows

before_install:
  - npm cache clean --force
  - rm -rf node_modules package-lock.json

script: 
  - npm run build-crc64 && if [ "$TRAVIS_OS_NAME" != "windows" ]; then npm run test-crc64; fi

after_success:
  - git config --global user.name "fool bot"
  - git config --global user.email "919060679@qq.com"
  - git add .
  - git commit -m "[skip travis] ci:build crc64 for $TRACIS_OS_NAME on travis"
  - git push "https://${GH_TOKEN}@${GH}" test/ci:test/ci
