language: "node_js"

node_js: '12'

branches:
  only:
  - test/ci

os:
  - linux
  - osx
  - windows

before_install:
  - npm cache clean
  - rm -rf node_modules package-lock.json

script: 
  - npm run build-crc64
  - if [ "$TRAVIS_OS_NAME" != "windows" ]; then npm run test-crc64; fi

after_success:
  - eval "$(ssh-agent -s)" #start the ssh agent
  - chmod 600 .travis/deploy_key.pem # this key should have push access
  - ssh-add .travis/deploy_key.pem
  - git remote add deploy https://github.com/beajer/oss-browser.git
  - git push deploy